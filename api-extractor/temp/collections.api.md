## API Report File for "@keywork/collections"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

/// <reference types="@cloudflare/workers-types" />

import deepmerge from 'deepmerge';
import { ETaggable } from 'keywork';
import { PathBuilder } from '@keywork/utils';

// @public (undocumented)
export interface CollectionDocumentReferencesResponse<ExpectedType extends DeserializationTypes | {}> extends KVNamespaceListResult<unknown> {
    // (undocumented)
    documents: KeyworkDocumentReference<ExpectedType>[];
}

// @public (undocumented)
export interface CreateKeyworkDocumentMetadataOptions {
    absoluteDocPath: string;
    createdAt: Date;
    deserializeAs?: DeserializationTransformers;
    etag?: string | null;
    relativeDocPath: string;
}

// @public (undocumented)
export type DeserializationTransformers = 'text' | 'json' | 'arrayBuffer' | 'stream';

// @public (undocumented)
export type DeserializationTypes = string | ArrayBuffer | ReadableStream;

// @public (undocumented)
export interface FetchListOptions extends Omit<KVNamespaceListOptions, 'prefix'> {
}

// @public
export function generateDocumentMetadata({ absoluteDocPath, relativeDocPath, createdAt, deserializeAs, etag, }: CreateKeyworkDocumentMetadataOptions): KeyworkDocumentMetadata;

// @public
export function isETaggable(value: unknown,
deserializeAs?: DeserializationTransformers): value is ETaggable;

// @public (undocumented)
export class KeyworkCollection<ExpectedType extends DeserializationTypes | {}> {
    constructor(
    kvNamespace: KVNamespace,
    collectionPath: string);
    // @internal
    protected __documentsPath: PathBuilder;
    // @internal
    protected __indexByDocumentPath: PathBuilder;
    // @internal
    protected __indexByIDPath: PathBuilder;
    // @internal
    protected __indexesPath: PathBuilder;
    // @internal
    protected __indexPathByPropertyName: Record<keyof ExpectedType, string | undefined>;
    // @internal
    protected __indexPrefixesPath: PathBuilder;
    // (undocumented)
    addEntryToIndexes<E extends ExpectedType>(entry: E, metadata: KeyworkDocumentMetadata): Promise<void>;
    collectionPath: string;
    createDocumentReference(relativeDocPath: string): KeyworkDocumentReference<ExpectedType>;
    fetchDocumentMetadataByPath(relativeDocPath: string): Promise<null | KeyworkDocumentMetadata>;
    fetchDocuments(options?: FetchListOptions): Promise<CollectionDocumentReferencesResponse<ExpectedType>>;
    // (undocumented)
    fetchDocumentsList(options?: FetchListOptions): Promise<{
        keys: (string | undefined)[];
        list_complete: boolean;
        cursor?: string | undefined;
    }>;
    fetchDocumentsListByID(options?: FetchListOptions): Promise<KVNamespaceListResult<KeyworkDocumentMetadata>>;
    // (undocumented)
    protected fetchIndexPrefixes(): Promise<string[]>;
    // (undocumented)
    initialize(): Promise<this>;
    protected kvNamespace: KVNamespace;
    // (undocumented)
    permanentlyDeleteThisCollection(): void;
    // (undocumented)
    query(): Promise<void>;
}

// @public
export class KeyworkDatabase {
    constructor(
    kvNamespace: KVNamespace);
    collection(collectionPath: string): Promise<KeyworkCollection<{} | DeserializationTypes>>;
    doc<ExpectedType extends DeserializationTypes | {} = never>(docPath: string): KeyworkDocumentReference<ExpectedType>;
    protected kvNamespace: KVNamespace;
}

// @public (undocumented)
export interface KeyworkDocumentFetchOptions {
    cacheTtl?: number;
    deserializeAs?: DeserializationTransformers;
}

// @public
export interface KeyworkDocumentMetadata extends PutOrPatchOptions {
    absoluteDocPath: string;
    // (undocumented)
    createdAt: string;
    deserializeAs: DeserializationTransformers;
    etag: string | null;
    id: string;
    relativeDocPath: string;
    // (undocumented)
    updatedAt: string;
}

// @public
export class KeyworkDocumentReference<ExpectedType extends DeserializationTypes | {} = never> {
    constructor(
    kvNamespace: KVNamespace,
    relativeDocPath: string, parentCollection?: KeyworkCollection<ExpectedType> | undefined);
    readonly absoluteDocPath: string;
    fetchSnapshot(options?: KeyworkDocumentFetchOptions): Promise<KeyworkDocumentSnapshot<ExpectedType>>;
    protected readonly kvNamespace: KVNamespace;
    // (undocumented)
    protected readonly parentCollection?: KeyworkCollection<ExpectedType> | undefined;
    patchValue<E = ExpectedType>(nextValue: Partial<E>, options?: PutOrPatchOptions, snapshot?: KeyworkDocumentSnapshot<E>, deepMergeOptions?: deepmerge.Options): Promise<this>;
    putValue<E = ExpectedType>(nextValue: Partial<E>, putOptions?: PutOrPatchOptions): Promise<this>;
    readonly relativeDocPath: string;
}

// @public (undocumented)
export type KeyworkDocumentSnapshot<ExpectedType = unknown> = KeyworkDocumentSnapshotExists<ExpectedType> | KeyworkDocumentSnapshotDoesNotExist;

// @public (undocumented)
export interface KeyworkDocumentSnapshotDoesNotExist {
    // (undocumented)
    absoluteDocPath: string;
    // (undocumented)
    exists: false;
    // (undocumented)
    metadata: null;
    // (undocumented)
    relativeDocPath: string;
    // (undocumented)
    value: null;
}

// @public (undocumented)
export interface KeyworkDocumentSnapshotExists<ExpectedType = unknown> {
    // (undocumented)
    absoluteDocPath: string;
    // (undocumented)
    exists: true;
    // (undocumented)
    metadata: KeyworkDocumentMetadata;
    // (undocumented)
    relativeDocPath: string;
    // (undocumented)
    value: ExpectedType;
}

// @internal
export function _parseValueTypeInfo(value: unknown): DeserializationTransformers;

export { PathBuilder }

// @public (undocumented)
export interface PutOrPatchOptions {
    // (undocumented)
    expiration?: number;
    // (undocumented)
    expirationTtl?: number;
}

// (No @packageDocumentation comment for this package)

```
